<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Automatic Google Drive Slideshow</title>
  <style>
    body { margin: 0; background: #000; }
    .slideshow {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      min-height: 100vh;
    }
    .slideshow img {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: contain;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }
    .slideshow img.active {
      opacity: 1;
    }
  </style>
</head>
<body>

<div class="slideshow" id="slideshow"></div>

<script>
  const API_KEY = "AIzaSyDjBy4NFEUCw1wn1wcwAYEYVE1prDl1axE";
  const FOLDER_ID = "1O0gDx3GebfpVZrfQGkCHCZMBwN_I4ebC";

  // Shuffle function (Fisherâ€“Yates)
  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  async function loadImages() {
    const url = `https://www.googleapis.com/drive/v3/files?q='${FOLDER_ID}'+in+parents&key=${API_KEY}&fields=files(id,name,mimeType)`;

    const response = await fetch(url);
    const data = await response.json();

    // Shuffle the images before displaying
    shuffle(data.files);

    const slideshow = document.getElementById("slideshow");

    data.files.forEach((file, index) => {
      if (file.mimeType.startsWith("image/")) {
        const img = document.createElement("img");
        img.src = `https://lh3.googleusercontent.com/d/${file.id}=s1920`;
        if (index === 0) img.classList.add("active");
        slideshow.appendChild(img);
      }
    });

    startSlideshow();
  }

  let slideshowInterval = null;
  let isPaused = false;
  let currentIndex = 0;

  function startSlideshow() {
    const slides = document.querySelectorAll("#slideshow img");
    currentIndex = 0;

    slideshowInterval = setInterval(() => {
      nextSlide();
    }, 3000);
  }

  function nextSlide() {
    const slides = document.querySelectorAll("#slideshow img");
    slides[currentIndex].classList.remove("active");
    currentIndex = (currentIndex + 1) % slides.length;
    slides[currentIndex].classList.add("active");
  }

  function prevSlide() {
    const slides = document.querySelectorAll("#slideshow img");
    slides[currentIndex].classList.remove("active");
    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
    slides[currentIndex].classList.add("active");
  }

  // Keyboard controls
  document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowRight") {
      nextSlide();
    }
    if (e.key === "ArrowLeft") {
      prevSlide();
    }
    if (e.key === " ") {
      e.preventDefault();
      if (isPaused) {
        slideshowInterval = setInterval(nextSlide, 3000);
      } else {
        clearInterval(slideshowInterval);
      }
      isPaused = !isPaused;
    }
  });

  loadImages();
</script>

</body>
</html>
